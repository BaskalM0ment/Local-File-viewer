<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Local Media & Document Viewer</title>

<style>
:root {
    --bg:#0e0e0e; --text:#fff; --panel:#1a1a1a;
    --border:#555; --btn:#2e7dff; --btnh:#1f5fd1;
}
body.light {
    --bg:#f2f2f2; --text:#000; --panel:#fff;
    --border:#aaa; --btn:#0066ff; --btnh:#004ccc;
}
body {
    background:var(--bg); color:var(--text);
    font-family:Arial,sans-serif; margin:0;
    height:100vh; display:flex; flex-direction:column;
    align-items:center; justify-content:center;
}
.drop-zone {
    width:380px; padding:30px; border:3px dashed var(--border);
    border-radius:14px; background:var(--panel);
    text-align:center; cursor:pointer;
}
.drop-zone.dragover { border-color:var(--btn); }
button {
    margin-top:15px; background:var(--btn);
    color:#fff; border:none; padding:10px 18px;
    border-radius:8px; cursor:pointer;
}
button:hover { background:var(--btnh); }
video,audio,iframe,pre {
    width:80%; max-width:900px;
    margin-top:25px; background:#000;
}
pre {
    padding:20px; overflow:auto; background:var(--panel);
}
.hidden { display:none; }
.toggle { position:absolute; top:20px; right:20px; }
</style>
</head>
<body>

<div class="toggle">
    <button id="themeToggle">Light Mode</button>
</div>

<h1>Local Media & Document Viewer</h1>
<p>Everything stays on your device. Nothing is uploaded.</p>

<div class="drop-zone" id="dropZone">
    Drag & Drop a file<br><br>
    <button onclick="fileInput.click()">Choose File</button>
</div>

<input type="file" id="fileInput">

<div id="status"></div>

<video id="video" controls class="hidden"></video>
<audio id="audio" controls class="hidden"></audio>
<iframe id="pdf" class="hidden" height="600"></iframe>
<pre id="text" class="hidden"></pre>

<script>
const fileInput = document.getElementById("fileInput");
const dropZone = document.getElementById("dropZone");
const status = document.getElementById("status");
const video = document.getElementById("video");
const audio = document.getElementById("audio");
const pdf = document.getElementById("pdf");
const text = document.getElementById("text");
const themeToggle = document.getElementById("themeToggle");

const blocked = ["exe","bat","cmd","msi","js","vbs","ps1","apk","dll","scr"];

function reset() {
    video.classList.add("hidden");
    audio.classList.add("hidden");
    pdf.classList.add("hidden");
    text.classList.add("hidden");
}

function handleFile(file) {
    reset();
    const ext = file.name.split(".").pop().toLowerCase();
    if (blocked.includes(ext)) {
        status.textContent = "Blocked unsafe file type.";
        return;
    }

    const url = URL.createObjectURL(file);

    if (file.type.startsWith("video/")) {
        video.src = url;
        video.classList.remove("hidden");
        video.play();
    }
    else if (file.type.startsWith("audio/")) {
        audio.src = url;
        audio.classList.remove("hidden");
        audio.play();
    }
    else if (file.type === "application/pdf") {
        pdf.src = url;
        pdf.classList.remove("hidden");
    }
    else if (file.type.startsWith("text/")) {
        file.text().then(t => {
            text.textContent = t;
            text.classList.remove("hidden");
        });
    }
    else {
        const a = document.createElement("a");
        a.href = url;
        a.download = file.name;
        a.textContent = "Download document: " + file.name;
        status.innerHTML = "";
        status.appendChild(a);
        return;
    }

    status.textContent = "Loaded locally. No upload occurred.";
}

fileInput.onchange = () => handleFile(fileInput.files[0]);

dropZone.ondragover = e => { e.preventDefault(); dropZone.classList.add("dragover"); };
dropZone.ondragleave = () => dropZone.classList.remove("dragover");
dropZone.ondrop = e => {
    e.preventDefault();
    dropZone.classList.remove("dragover");
    handleFile(e.dataTransfer.files[0]);
};

// Theme memory
if (localStorage.theme === "light") {
    document.body.classList.add("light");
    themeToggle.textContent = "Dark Mode";
}
themeToggle.onclick = () => {
    document.body.classList.toggle("light");
    localStorage.theme = document.body.classList.contains("light") ? "light" : "dark";
    themeToggle.textContent = localStorage.theme === "light" ? "Dark Mode" : "Light Mode";
};
</script>

</body>
</html>
