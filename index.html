<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Local Media & Document Viewer</title>

<style>
:root {
    --bg:#0e0e0e;
    --text:#ffffff;
    --panel:#1a1a1a;
    --border:#555;
    --btn:#2e7dff;
    --btnh:#1f5fd1;
}

body.light {
    --bg:#f2f2f2;
    --text:#000000;
    --panel:#ffffff;
    --border:#aaa;
    --btn:#0066ff;
    --btnh:#004ccc;
}

body {
    background:var(--bg);
    color:var(--text);
    font-family:Arial,sans-serif;
    margin:0;
    height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
}

h1 { margin-bottom:10px; }
p { margin-bottom:20px; opacity:0.8; }

.drop-zone {
    width:420px;
    padding:35px;
    border:3px dashed var(--border);
    border-radius:16px;
    background:var(--panel);
    text-align:center;
    cursor:pointer;
    transition:0.2s;
}

.drop-zone.dragover {
    border-color:var(--btn);
    background:rgba(46,125,255,0.1);
}

/* IMPORTANT: fully hide file input */
input[type="file"] {
    display:none;
}

button {
    margin-top:18px;
    background:var(--btn);
    color:white;
    border:none;
    padding:12px 22px;
    border-radius:10px;
    cursor:pointer;
    font-size:1rem;
}

button:hover { background:var(--btnh); }

video,audio {
    width:80%;
    max-width:900px;
    margin-top:30px;
    background:black;
}

.hidden { display:none; }

.toggle {
    position:absolute;
    top:20px;
    right:20px;
}

.help {
    position:absolute;
    bottom:15px;
    font-size:0.85rem;
    opacity:0.7;
    text-align:center;
}
</style>
</head>
<body>

<div class="toggle">
    <button id="themeToggle">Light Mode</button>
</div>

<h1>Local Media & Document Viewer</h1>
<p>Everything stays on your device. Nothing is uploaded.</p>

<div class="drop-zone" id="dropZone">
    <strong>Drag & Drop a file</strong><br><br>
    or<br><br>
    <button id="chooseBtn">Choose File</button>
</div>

<input type="file" id="fileInput">

<div id="status"></div>

<video id="video" controls class="hidden"></video>
<audio id="audio" controls class="hidden"></audio>

<div class="help">
    Space: Play/Pause · F: Fullscreen · M: Mute · ← → Seek · ↑ ↓ Volume · L: Theme
</div>

<script>
const fileInput = document.getElementById("fileInput");
const chooseBtn = document.getElementById("chooseBtn");
const dropZone = document.getElementById("dropZone");
const status = document.getElementById("status");
const video = document.getElementById("video");
const audio = document.getElementById("audio");
const themeToggle = document.getElementById("themeToggle");

const blocked = ["exe","bat","cmd","msi","js","vbs","ps1","apk","dll","scr"];
let currentMedia = null;

/* ---------- THEME MEMORY ---------- */
if (localStorage.theme === "light") {
    document.body.classList.add("light");
    themeToggle.textContent = "Dark Mode";
}

themeToggle.onclick = () => {
    document.body.classList.toggle("light");
    const isLight = document.body.classList.contains("light");
    localStorage.theme = isLight ? "light" : "dark";
    themeToggle.textContent = isLight ? "Dark Mode" : "Light Mode";
};

/* ---------- FILE HANDLING ---------- */
function reset() {
    video.classList.add("hidden");
    audio.classList.add("hidden");
    status.textContent = "";
}

function handleFile(file) {
    reset();

    const ext = file.name.split(".").pop().toLowerCase();
    if (blocked.includes(ext)) {
        status.textContent = "Blocked unsafe file type.";
        return;
    }

    const url = URL.createObjectURL(file);

    if (file.type.startsWith("video/")) {
        currentMedia = video;
        video.src = url;
        video.classList.remove("hidden");
        video.play();
    }
    else if (file.type.startsWith("audio/")) {
        currentMedia = audio;
        audio.src = url;
        audio.classList.remove("hidden");
        audio.play();
    }
    else if (file.type === "application/pdf") {
        // OPEN PDF CLEANLY IN NEW TAB
        window.open(url, "_blank");
        status.textContent = "PDF opened in new tab.";
        return;
    }
    else {
        // Other documents → download/open locally
        const a = document.createElement("a");
        a.href = url;
        a.download = file.name;
        a.click();
        status.textContent = "Document opened locally.";
        return;
    }

    status.textContent = "Loaded locally. No upload occurred.";
}

/* ---------- BUTTON & DROP ---------- */
chooseBtn.onclick = () => fileInput.click();

fileInput.onchange = () => {
    if (fileInput.files[0]) handleFile(fileInput.files[0]);
};

dropZone.ondragover = e => {
    e.preventDefault();
    dropZone.classList.add("dragover");
};

dropZone.ondragleave = () => dropZone.classList.remove("dragover");

dropZone.ondrop = e => {
    e.preventDefault();
    dropZone.classList.remove("dragover");
    if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
};

/* ---------- KEYBOARD SHORTCUTS ---------- */
document.addEventListener("keydown", e => {
    if (!currentMedia) return;

    switch (e.key.toLowerCase()) {
        case " ":
            e.preventDefault();
            currentMedia.paused ? currentMedia.play() : currentMedia.pause();
            break;
        case "f":
            if (currentMedia.tagName === "VIDEO") {
                document.fullscreenElement
                    ? document.exitFullscreen()
                    : currentMedia.requestFullscreen();
            }
            break;
        case "m":
            currentMedia.muted = !currentMedia.muted;
            break;
        case "arrowright":
            currentMedia.currentTime += 5;
            break;
        case "arrowleft":
            currentMedia.currentTime -= 5;
            break;
        case "arrowup":
            currentMedia.volume = Math.min(1, currentMedia.volume + 0.05);
            break;
        case "arrowdown":
            currentMedia.volume = Math.max(0, currentMedia.volume - 0.05);
            break;
        case "l":
            themeToggle.click();
            break;
    }
});
</script>

</body>
</html>
